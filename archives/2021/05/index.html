
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Summary">
    <title>Archives: 2021/5 - Summary</title>
    <meta name="author" content="Topsion">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta name="description" content="The whole problem with the world is that fools and fanatics are always so certain of themselves, and wiser people so full of doubts.(这个世界的问题在于聪明人充满疑惑而傻子却坚信不疑)">
<meta property="og:type" content="blog">
<meta property="og:title" content="Summary">
<meta property="og:url" content="http://example.com/archives/2021/05/index.html">
<meta property="og:site_name" content="Summary">
<meta property="og:description" content="The whole problem with the world is that fools and fanatics are always so certain of themselves, and wiser people so full of doubts.(这个世界的问题在于聪明人充满疑惑而傻子却坚信不疑)">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Topsion">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="http://example.com/assets/images/avatar.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-yaeygdlgk8x4rqd5mp0jrkosoe3fmfokggmiu05rmpel4wjoxmvp5s6gestz.min.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Summary
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Topsion</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Fullstack Developer</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="Search"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/wenPKtalk"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://stackoverflow.com/users/15967860/topsion"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Stack Overflow"
                        >
                        <i class="sidebar-button-icon fab fa-stack-overflow" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Stack Overflow</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/feed/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/22/%E7%BC%85%E6%80%80%E8%A2%81%E8%80%81/"
                            aria-label=": 缅怀袁老"
                        >
                            缅怀袁老
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-22T20:26:00+00:00">
	
		    May 22, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Daily-Life/">Daily Life</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>  今天听闻噩耗，袁隆平院士我们称之为袁老去世了享年 91 岁，随之朋友圈也炸锅了，大家都在缅怀，悼念。</p>
<p>  不得不说袁老对人类的贡献是伟大的，他是一个高尚的人，纯粹的人，脱离了低级趣味的人。找到了能够为之奋斗一生的事业，并在历史的篇章中留下了属于自己的篇章。</p>
<p>  我虽然还在自己家的一亩三分地上挣扎，但是偶尔还是会仰望星空，怎么说呢保持激情，不要锤头丧气就是很好的生活状态。</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/22/%E7%BC%85%E6%80%80%E8%A2%81%E8%80%81/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/16/2-Netty%E4%B8%AD%E6%98%AF%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96%E5%86%85%E5%AD%98%E7%9A%84/"
                            aria-label=": 2.Netty中是如何优化内存的"
                        >
                            2.Netty中是如何优化内存的
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-16T22:11:11+00:00">
	
		    May 16, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Netty/">Netty</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>Netty减少内存使用技巧：</p>
<ol>
<li><p>能使用基本类型就不使用包装类型</p>
</li>
<li><p>减少对象本身大小 -&gt; 应该定义成类变量的不要定义为实例变量</p>
</li>
<li><p>Zero-copy</p>
</li>
<li><p>Netty内存池使用</p>
<ul>
<li><p>内存池/非内存池的默认选择及切换方式</p>
<p>io.netty.channel.defaultChannelConfig#allocator</p>
</li>
<li><p>内存池实现 io.netty.buffer.pooledDirectByteBuf</p>
</li>
<li><p>对外内存/堆内内存的默认选择及切换方式</p>
</li>
<li><p>对外内存的分配本质</p>
</li>
</ul>
</li>
</ol>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/16/2-Netty%E4%B8%AD%E6%98%AF%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96%E5%86%85%E5%AD%98%E7%9A%84/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/12/1-Netty-%E4%B8%AD%E7%9A%84%E7%B2%98%E5%8C%85%E5%92%8C%E5%8D%8A%E5%8C%85/"
                            aria-label=": 1.Netty 中的粘包和半包"
                        >
                            1.Netty 中的粘包和半包
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-12T22:00:44+00:00">
	
		    May 12, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Netty/">Netty</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h3 id="粘包原因"><a href="#粘包原因" class="headerlink" title="粘包原因"></a>粘包原因</h3><ul>
<li>发送方每次写入数据 &lt; 套接字缓冲区大小</li>
<li>接受方读取套接字缓冲区数据不够及时</li>
</ul>
<h3 id="半包原因"><a href="#半包原因" class="headerlink" title="半包原因"></a>半包原因</h3><ul>
<li>发送方每次写入数据 &gt; 套接字缓冲区大小</li>
<li>发送方的数据大于协议的MTU（Maximum Transmission Unit 最大传输单元）必须拆包</li>
</ul>
<h3 id="根本原因"><a href="#根本原因" class="headerlink" title="根本原因"></a>根本原因</h3><p><strong>TCP是流式协议，消息无边际</strong></p>
<p>udp像邮寄包裹，虽然是一次运输多个，但是每个包裹都有“界限”，一个一个签收，所以无粘包，拆包问题。</p>
<h3 id="解决方式"><a href="#解决方式" class="headerlink" title="解决方式"></a>解决方式</h3><ol>
<li>改成短链接：一次链接发送一个数据包</li>
<li>封装成数据帧（fram）<ol>
<li>固定长度—空间浪费</li>
<li>分割符—内容里出现分隔符时需要转义</li>
<li>固定长度字段存储内容长度信息—长度理论上有限制，需提前预知可能的最大长度，从而定义长度占用字节数  <strong>推荐</strong></li>
<li>其它 如json里的{}</li>
</ol>
</li>
</ol>
<h3 id="netty解码方式"><a href="#netty解码方式" class="headerlink" title="netty解码方式"></a>netty解码方式</h3><p>假设我们把解决粘包/半包的问题的常用三种解码器叫一次解码</p>
<ul>
<li>固定长度  FixedLengthFrameDecoder  </li>
<li>分割符   DelimiterBasedFrameDecoder </li>
<li>固定长度字段存内容长度信心 LengthFieldBasedFrameDecoder    LengthFieldPrepender</li>
</ul>
<p>二次解码：将字节转换成为实际使用的对象</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/12/1-Netty-%E4%B8%AD%E7%9A%84%E7%B2%98%E5%8C%85%E5%92%8C%E5%8D%8A%E5%8C%85/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2021/05/12/%E4%BB%8EReactor%E6%A8%A1%E5%BC%8F%E8%AE%A4%E8%AF%86Netty/"
                            aria-label=": 从Reactor模式认识Netty"
                        >
                            从Reactor模式认识Netty
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2021-05-12T21:52:10+00:00">
	
		    May 12, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Netty/">Netty</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h3 id="IO定义"><a href="#IO定义" class="headerlink" title="IO定义"></a>IO定义</h3><p>BIO：Thread-Per-Connection</p>
<p>NIO：Reactor</p>
<p>AIO:   Proactor</p>
<h3 id="I-O多路复用（技术术语：Reactor）："><a href="#I-O多路复用（技术术语：Reactor）：" class="headerlink" title="I/O多路复用（技术术语：Reactor）："></a>I/O多路复用（技术术语：Reactor）：</h3><ol>
<li>当多条连接共用一个阻塞对象后，进程只需要在一个阻塞对象上等待，而无需再轮训所有连接，常见的实现方式有select，epoll，kqueue等。</li>
<li>当某条连接有新的数据可以处理时，操作系统会通知进程，进程从阻塞状态返回，开始进行业务处理。</li>
</ol>
<blockquote>
<p>Reactor是一种开发模式，Reactor中文翻译为：反应堆。不是物理上的核反应堆，这儿代表的是：“事件反应”，可以理解为：“来一个事件我（Reactor）就有相应的反应”。Reactor也可以叫Dispatcher模式：</p>
</blockquote>
<ul>
<li><p>Reactor的数量可以变化：可以是一个Reactor，也可以是多个Reactor</p>
</li>
<li><p>资源池的数量可以变化：可以是单线程，也可以是多线程</p>
</li>
</ul>
<h3 id="模式核心流程："><a href="#模式核心流程：" class="headerlink" title="模式核心流程："></a>模式核心流程：</h3><p>注册感兴趣的事件 -&gt; 扫描是否有兴趣的事件发生 -&gt; 事件发生后做出相应的处理</p>
<p>Reactor三种模式：</p>
<ul>
<li> 单线程（单Reactor单线程）</li>
<li>多线程（单Reactor多线程） </li>
<li>主从多线程（多Reactor多线程）</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Reactor单线程模式</td>
<td>EventLoopGroup eventGroup = new NioEventLoopGroup(1)<br />ServerBootstrap serverBootstrap = new ServerBootstrap();<br />serverBootstrap.group(eventGroup);</td>
</tr>
<tr>
<td>非主从Reactor多线程模式</td>
<td>EventLoopGroup eventGroup = new NioEventLoopGroup()<br />ServerBootstrap serverBootstrap = new ServerBootstrap();<br />serverBootstrap.group(eventGroup);</td>
</tr>
<tr>
<td>主从Reactor多线程模式</td>
<td>EventLoopGroup bossGroup = new NioEventLoopGroup()<br />EventLoopGroup workerGroup = new NioEventLoopGroup()<br />ServerBootstrap serverBootstrap = new ServerBootstrap();<br />serverBootstrap.group(bossGroup, workerGroup);</td>
</tr>
</tbody></table>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2021/05/12/%E4%BB%8EReactor%E6%A8%A1%E5%BC%8F%E8%AE%A4%E8%AF%86Netty/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Topsion. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Topsion</h4>
        
            <div id="about-card-bio"><p>Fullstack Developer</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Coder</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Xi&#39;an China
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-q2wtdh1f7oaxzdmuuvsc1uyl8fnwcg5dz7kgztdayssvj6qd6o7u5zwralwk.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
