
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Summary">
    <title>java如何利用Mockito写好单元测试 - Summary</title>
    <meta name="author" content="Topsion">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Topsion","sameAs":["https://github.com/wenPKtalk","https://stackoverflow.com/users/15967860/topsion","https://www.linkedin.com/feed/"],"image":"avatar.jpg"},"articleBody":"老生常谈之什么是单元测试\n单元测试是低级的，专注于软件系统的最小部分。\n单元测试是程序员自己使用某种测试框架来编写的。\n对于单元测试的期望是运行速度比其它的测试要更快。原文参照Martin Fowler博文\n\nUnit Test和TDD的关系\nTDD中的T到底是不是Unit Test 存争议，有的人说也可以是集成测试。以下是google测试经理的一段话：\n\n段念：把 TDD 等同于单元测试，认为 TDD 只是“提前写单元测试”这种想法应该是很多不太了解 TDD 的人容易犯的错误吧。如果把 TDD 放到敏捷开发的大背景下，我倒不觉得 TDD 有什么明显的不足，但如果单独考量 TDD 在企业中的实践，TDD 技术本身不关注代码的质量应该是一个明显的问题。应用 TDD 的企业通常需要采用持续的 Code Review 和 Refactory 方法保证通过 TDD 产生的代码的质量。\n\n\n\n原文链接：https://www.infoq.cn/article/virtual-panel-tdd/\n\n还有一段话我觉得比较好，下来总结下。\nTDD 并不是石头里蹦出来的孙悟空，DBC（Design By Contract）可以看作是 TDD 的前身。在 DBC 的观点里，设计应该以规约（Contract）的形势体现，规约定义了被开发对象的行为。\nTDD 中的 T，在表现形式上是“测试”，但其实，它更应该被理解为“对被实现对象”的行为限定，也就是 DBC 中的规约。\n“测试”只是用来体现规约的形式。 单元测试通常被定义为“对应用最小组成单位的测试”，它的测试对象通常是函数或是类，在对类的设计和实现应用 TDD 时，为类建立的测试通常与类的单元测试相当类似，因此 TDD 中的 T 往往被误认为是单元测试本身。\nTDD 中的 T 描述的是规约，是设计的一部分；\n其次，TDD 中的 T 并不明确要求 T 对实现代码的覆盖率；\n第三，TDD 的 T 的侧重点是“描述被实现对象应该具有的行为”，而不仅仅是“验证该类的行为是否正确”。\n第三，TDD 的 T 的侧重点是“描述被实现对象应该具有的行为”，而不仅仅是“验证该类的行为是否正确”。当然，TDD 中的 T 在形式上是测试，在重构中也可以作为被实现对象的行为验证框架。\n单元测试、集成测试、系统测试、用户验收测试是基于传统软件开发过程的划分，在传统软件开发观点中，这几类测试不仅意味这测试对象的不同，同样也以为着不同的测试在开发周期中处于不同的位置。但在敏捷开发中，如果继续使用这几个名词，最多也只能保留它们在测试对象方面的含义。对于 TDD 来说（ATDD 和 BDD 可以认为是 TDD 的变体），在不同的测试类别中都可以应用之，唯一的区别在于 T 面向的对象不同。\n\n\n\n测试框架Mockito 和 PowerMock介绍\nMockito可以让你写出优雅、简洁的单元测试代码。Mockito采用了模拟技术，模拟了一些在应用中依赖的复杂对象，从而把测试对象和依赖对象隔离开来。\nPowerMock是在其他单元测试框架的基础上做了增强。PowerMock实现了对静态方法、构造方法、私有方法以及final方法的模拟支持等强大功能。 但是实现方式是通过提供定制的类加载器以及一些字节码篡改技术，会导致部分单元测试用例不会被覆盖率检测工具检测到，所以迫不得已不推荐使用。\n\n利用Spring 搭配 Mockito 编写单元测试\n如下一个典型的用户service服务。\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051@Servicepublic class UserService &#123;    @Autowired    private UserDao userDao;    /*Id 生成器*/    @Autowired    private IdGenerator idGenerator;    /**     * 配置参数     */    @Value(&quot;$&#123;userService.canModify&#125;&quot;)    private Boolean canModify;    /**     * 创建用户     *     * @param userCreate 用户创建     * @return 用户标识     */    public Long createUser(UserVO userCreate) &#123;        // 获取用户标识        Long userId = userDAO.getIdByName(userCreate.getName());        // 根据存在处理        // 根据存在处理: 不存在则创建        if (Objects.isNull(userId)) &#123;            userId = idGenerator.next();            UserDO create = new UserDO();            create.setId(userId);            create.setName(userCreate.getName());            userDAO.create(create);        &#125;        // 根据存在处理: 已存在可修改        else if (Boolean.TRUE.equals(canModify)) &#123;            UserDO modify = new UserDO();            modify.setId(userId);            modify.setName(userCreate.getName());            userDAO.modify(modify);        &#125;        // 根据存在处理: 已存在禁修改        else &#123;            throw new UnsupportedOperationException(&quot;不支持修改&quot;);        &#125;        // 返回用户标识        return userId;    &#125;&#125;\n针对以上service服务在编写单元测试时，针对它的依赖userDao, idGenerator, canModify我们采用stub来预设存根。这样可以保证我们service只测试自己的逻辑。\n\n\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172@ExtendWith(MockitoExtension.class)class UserServiceTest &#123;     /** 模拟依赖对象 */    /** 用户DAO */    @Mock    private UserDAO userDAO;    /** 标识生成器 */    @Mock    private IdGenerator idGenerator;    /** 定义被测对象 */    /** 用户服务 */    @InjectMocks    private UserService userService;    /**     * 在测试之前     */    @Before    public void beforeTest() &#123;        // 注入依赖对象        ReflectionTestUtils.setField(Boolean.class, &quot;canModify&quot;, false);    &#125;    /**  *测试方法  *也可以使用 @Display 来标注测试方法名称。保证从测试方法名称中能读懂测试的目的，和简单的上下文。  * 注意此处的Test引用jupiter提供的注解。不然会有注入的空指针  */  @Test    void should_createUserWithNew_givenInfo_WhenNotExisted()&#123;    //given data; stub    when(userDAO).getIdByName(any()).thenReturn(null);    Long userId = 1L;    when(idGenerator).next().thenReturn(userId);    UserVO userCreate = new UserVo(***,***,***);        //when    Long acturalUserId = userService.createUser(userCreate);        //then    assertEquals(userId, acturalUserId);    // 验证依赖方法    // 验证依赖方法: userDAO.getByName   Mockito.verify(userDAO).getIdByName(userCreate.getName());   // 验证依赖方法: idGenerator.next   Mockito.verify(idGenerator).next();   // 验证依赖方法: userDAO.create   ArgumentCaptor &lt;UserDO&gt; userCreateCaptor = ArgumentCaptor.forClass(UserDO.class);   Mockito.verify(userDAO).create(userCreateCaptor.capture());   // 验证依赖对象   Mockito.verifyNoMoreInteractions(idGenerator, userDAO);  &#125;&#125;@Testvoid should_updateUser_givenUser_whenHasExisted()&#123;  //只需要stub此处修改，然后进行已存在断言  Long userId = 1L;  when(userDAO).getIdByName(any()).thenReturn(userId);    //then  ....&#125;@Testvoid should_exception_givenInvalid()&#123;  //then 断言采用Junit 5提供的  Assert.assertThrows(&quot;返回异常不一致&quot;,            UnsupportedOperationException.class, () -&gt; userService.createUser(userCreate))&#125;\n\n如何测试Controller\n保证Api层的访问状态是成功的\n保证入参校验逻辑是可通过的。\n与Service测试不同的是我们要启动web服务，所以必须启动spring容器。但是为了可测service服务我们还是利用Stub技术给出预期返回值。\n利用Spring 提供的@Import({*****.class}}指定我们容器中需要的类，可以方便的避免容器需要加载所有bean很慢的尴尬。\n\n12345678910111213141516171819202122232425262728293031323334@WebMvcTest(controllers = UserController.class, useDefaultFilters = false)@Import(&#123;UserController.class,        AopAutoConfiguration.class,        DependenceService.class&#125;)@ActiveProfiles(&quot;test&quot;)class UserControllerTest extends ControllerBaseTest &#123;    /**  *利用Import和Autowired可以将真是的bean在运行测试的时候注入进来。会调用真是的方法。  */    @Autowired     private MockMvc mvc;      @Autowired    private DependenceService service;      @MockBean    private UserService service;      @Test    void should_200_when_create() &#123;      Long userId = 1L;      when(service.createUser(any())).thenReturn(userId);            //when      mvc.perform(MockMvcRequestBuilders.post(&quot;/user&quot;)                        .content(jsonString) //given data                        .header(&quot;X-TIME-ZONE&quot;, &quot;Asia/Shanghai&quot;)                        .with(csrf())                        .contentType(MediaType.APPLICATION_JSON))                .andExpect(status().isOk());//then    &#125;  &#125;\n\n\n使用ArgumentCaptor验证代码中间被stub掉方法的参数.\n存在一种情况我们给serviceA中的methodA写单元测试的过程中，发现调用了serviceB的methodB方法，并且为serviceB方法new 了一个ObjectA对象作为调用serviceB.methodB的参数，如下：\n123456789101112131415161718public class ServiceA &#123;  @Autowired  public ServiceB serviceB    public void methodA() &#123;    /*    * 其它业务代码     */    for (i = 0; i &lt; 3; i++ )&#123;    \tObjectA objA = new ObjectA();      ObjcetB objB = serviceB.methodB(&quot;hello&quot;, objA);      &#125;    /*    * 其它业务代码     */      &#125;&#125;\n\n此时在测试 methodA的时候，需要使用测试替身代替真实的serviceB.methodB(objA);调用，这个时候我们不能使用 Mockito.when(serviceB.methodB(eq(“hello”), eq(new ObjectA())))来进行替换，因为new出来的对象是不同的对象所以stub不住。这个时候应该使用使用ArgumentCaptor进行捕获后验证，如下：\n12345678910ArgumentCaptor&lt;ObjectA&gt; objACaptor = ArgumentCaptor.forClass(ObjectA.class);//利用mockito.when().thenReturn()返回多个对象来stub循环中的三方调用Mockito.when(serviceB.methodB(eq(&quot;hello&quot;), objACaptor.caputre())).thenReturn(objB1, obj2, obj3);//然后获取三次captor捕获的三个参数进行验证。List&lt;ObjectA&gt; objAs = objACaptor.getValues();//验证三次参数Assertions.assertEquals(objAs(0), objB1);Assertions.assertEquals(objAs(1), objB2);Assertions.assertEquals(objAs(2), objB2);\n\n相关链接Java编程技巧之单元测试用例编写流程：https://zhuanlan.zhihu.com/p/371759603\n谈一谈单元测试：https://mp.weixin.qq.com/s/ioya1kzdTGPB0oOZ3DUmig\n","dateCreated":"2022-04-04T23:31:48+00:00","dateModified":"2025-08-25T15:47:34+00:00","datePublished":"2022-04-04T23:31:48+00:00","description":"","headline":"java如何利用Mockito写好单元测试","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"},"publisher":{"@type":"Organization","name":"Topsion","sameAs":["https://github.com/wenPKtalk","https://stackoverflow.com/users/15967860/topsion","https://www.linkedin.com/feed/"],"image":"avatar.jpg","logo":{"@type":"ImageObject","url":"avatar.jpg"}},"url":"http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/","keywords":"Unit Test"}</script>
    <meta name="description" content="老生常谈之什么是单元测试 单元测试是低级的，专注于软件系统的最小部分。 单元测试是程序员自己使用某种测试框架来编写的。 对于单元测试的期望是运行速度比其它的测试要更快。原文参照Martin Fowler博文  Unit Test和TDD的关系 TDD中的T到底是不是Unit Test 存争议，有的人说也可以是集成测试。以下是google测试经理的一段话：  段念：把 TDD 等同于单元测试，认为">
<meta property="og:type" content="blog">
<meta property="og:title" content="java如何利用Mockito写好单元测试">
<meta property="og:url" content="http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/index.html">
<meta property="og:site_name" content="Summary">
<meta property="og:description" content="老生常谈之什么是单元测试 单元测试是低级的，专注于软件系统的最小部分。 单元测试是程序员自己使用某种测试框架来编写的。 对于单元测试的期望是运行速度比其它的测试要更快。原文参照Martin Fowler博文  Unit Test和TDD的关系 TDD中的T到底是不是Unit Test 存争议，有的人说也可以是集成测试。以下是google测试经理的一段话：  段念：把 TDD 等同于单元测试，认为">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-04-04T23:31:48.000Z">
<meta property="article:modified_time" content="2025-08-25T15:47:34.901Z">
<meta property="article:author" content="Topsion">
<meta property="article:tag" content="Unit Test">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="http://example.com/assets/images/avatar.jpg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-yaeygdlgk8x4rqd5mp0jrkosoe3fmfokggmiu05rmpel4wjoxmvp5s6gestz.min.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Summary
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="4">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Topsion</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Fullstack Developer</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="Search"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/wenPKtalk"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://stackoverflow.com/users/15967860/topsion"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Stack Overflow"
                        >
                        <i class="sidebar-button-icon fab fa-stack-overflow" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Stack Overflow</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/feed/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            java如何利用Mockito写好单元测试
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2022-04-04T23:31:48+00:00">
	
		    Apr 04, 2022
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Unit-Test/">Unit Test</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h3 id="老生常谈之什么是单元测试"><a href="#老生常谈之什么是单元测试" class="headerlink" title="老生常谈之什么是单元测试"></a>老生常谈之什么是单元测试</h3><ol>
<li>单元测试是低级的，专注于软件系统的最小部分。</li>
<li>单元测试是程序员自己使用某种测试框架来编写的。</li>
<li>对于单元测试的期望是运行速度比其它的测试要更快。<br><a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/UnitTest.html">原文参照Martin Fowler博文</a></li>
</ol>
<h3 id="Unit-Test和TDD的关系"><a href="#Unit-Test和TDD的关系" class="headerlink" title="Unit Test和TDD的关系"></a>Unit Test和TDD的关系</h3><ol>
<li><p>TDD中的T到底是不是Unit Test 存争议，有的人说也可以是集成测试。以下是google测试经理的一段话：</p>
<blockquote>
<p><strong>段念</strong>：把 TDD 等同于单元测试，认为 TDD 只是“提前写单元测试”这种想法应该是很多不太了解 TDD 的人容易犯的错误吧。如果把 TDD 放到敏捷开发的大背景下，我倒不觉得 TDD 有什么明显的不足，但如果单独考量 TDD 在企业中的实践，TDD 技术本身不关注代码的质量应该是一个明显的问题。应用 TDD 的企业通常需要采用持续的 Code Review 和 Refactory 方法保证通过 TDD 产生的代码的质量。</p>
</blockquote>
</li>
</ol>
<p>原文链接：<a target="_blank" rel="noopener" href="https://www.infoq.cn/article/virtual-panel-tdd/">https://www.infoq.cn/article/virtual-panel-tdd/</a></p>
<ol start="2">
<li>还有一段话我觉得比较好，下来总结下。<ul>
<li>TDD 并不是石头里蹦出来的孙悟空，DBC（Design By Contract）可以看作是 TDD 的前身。在 DBC 的观点里，设计应该以规约（Contract）的形势体现，规约定义了被开发对象的行为。</li>
<li>TDD 中的 T，在表现形式上是“测试”，但其实，它更应该被理解为“对被实现对象”的行为限定，也就是 DBC 中的规约。</li>
<li>“测试”只是用来体现规约的形式。 单元测试通常被定义为“对应用最小组成单位的测试”，它的测试对象通常是函数或是类，在对类的设计和实现应用 TDD 时，为类建立的测试通常与类的单元测试相当类似，因此 TDD 中的 T 往往被误认为是单元测试本身。</li>
<li>TDD 中的 T 描述的是规约，是设计的一部分；</li>
<li>其次，TDD 中的 T 并不明确要求 T 对实现代码的覆盖率；</li>
<li>第三，TDD 的 T 的侧重点是“描述被实现对象应该具有的行为”，而不仅仅是“验证该类的行为是否正确”。</li>
<li>第三，TDD 的 T 的侧重点是“描述被实现对象应该具有的行为”，而不仅仅是“验证该类的行为是否正确”。当然，TDD 中的 T 在形式上是测试，在重构中也可以作为被实现对象的行为验证框架。</li>
<li>单元测试、集成测试、系统测试、用户验收测试是基于传统软件开发过程的划分，在传统软件开发观点中，这几类测试不仅意味这测试对象的不同，同样也以为着不同的测试在开发周期中处于不同的位置。但在敏捷开发中，如果继续使用这几个名词，最多也只能保留它们在测试对象方面的含义。对于 TDD 来说（ATDD 和 BDD 可以认为是 TDD 的变体），在不同的测试类别中都可以应用之，唯一的区别在于 T 面向的对象不同。</li>
</ul>
</li>
</ol>
<h3 id="测试框架Mockito-和-PowerMock介绍"><a href="#测试框架Mockito-和-PowerMock介绍" class="headerlink" title="测试框架Mockito 和 PowerMock介绍"></a>测试框架Mockito 和 PowerMock介绍</h3><ol>
<li>Mockito可以让你写出优雅、简洁的单元测试代码。Mockito采用了模拟技术，模拟了一些在应用中依赖的复杂对象，从而把测试对象和依赖对象隔离开来。</li>
<li>PowerMock是在其他单元测试框架的基础上做了增强。<strong>PowerMock实现了对静态方法、构造方法、私有方法以及final方法的模拟支持等强大功能。</strong> 但是实现方式是通过提供定制的类加载器以及一些字节码篡改技术，会导致部分单元测试用例不会被覆盖率检测工具检测到，所以迫不得已不推荐使用。</li>
</ol>
<h3 id="利用Spring-搭配-Mockito-编写单元测试"><a href="#利用Spring-搭配-Mockito-编写单元测试" class="headerlink" title="利用Spring 搭配 Mockito 编写单元测试"></a>利用Spring 搭配 Mockito 编写单元测试</h3><ol>
<li><p>如下一个典型的用户service服务。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*Id 生成器*/</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IdGenerator idGenerator;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;userService.canModify&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Boolean canModify;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建用户</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userCreate 用户创建</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 用户标识</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">createUser</span><span class="params">(UserVO userCreate)</span> &#123;</span><br><span class="line">        <span class="comment">// 获取用户标识</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> userDAO.getIdByName(userCreate.getName());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 根据存在处理</span></span><br><span class="line">        <span class="comment">// 根据存在处理: 不存在则创建</span></span><br><span class="line">        <span class="keyword">if</span> (Objects.isNull(userId)) &#123;</span><br><span class="line">            userId = idGenerator.next();</span><br><span class="line">            <span class="type">UserDO</span> <span class="variable">create</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDO</span>();</span><br><span class="line">            create.setId(userId);</span><br><span class="line">            create.setName(userCreate.getName());</span><br><span class="line">            userDAO.create(create);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 根据存在处理: 已存在可修改</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (Boolean.TRUE.equals(canModify)) &#123;</span><br><span class="line">            <span class="type">UserDO</span> <span class="variable">modify</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserDO</span>();</span><br><span class="line">            modify.setId(userId);</span><br><span class="line">            modify.setName(userCreate.getName());</span><br><span class="line">            userDAO.modify(modify);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 根据存在处理: 已存在禁修改</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UnsupportedOperationException</span>(<span class="string">&quot;不支持修改&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 返回用户标识</span></span><br><span class="line">        <span class="keyword">return</span> userId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>针对以上service服务在编写单元测试时，针对它的依赖userDao, idGenerator, canModify我们采用stub来预设存根。这样可以保证我们service只测试自己的逻辑。</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ExtendWith(MockitoExtension.class)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserServiceTest</span> &#123;</span><br><span class="line">     <span class="comment">/** 模拟依赖对象 */</span></span><br><span class="line">    <span class="comment">/** 用户DAO */</span></span><br><span class="line">    <span class="meta">@Mock</span></span><br><span class="line">    <span class="keyword">private</span> UserDAO userDAO;</span><br><span class="line">    <span class="comment">/** 标识生成器 */</span></span><br><span class="line">    <span class="meta">@Mock</span></span><br><span class="line">    <span class="keyword">private</span> IdGenerator idGenerator;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** 定义被测对象 */</span></span><br><span class="line">    <span class="comment">/** 用户服务 */</span></span><br><span class="line">    <span class="meta">@InjectMocks</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 在测试之前</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeTest</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 注入依赖对象</span></span><br><span class="line">        ReflectionTestUtils.setField(Boolean.class, <span class="string">&quot;canModify&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  *测试方法</span></span><br><span class="line"><span class="comment">  *也可以使用 <span class="doctag">@Display</span> 来标注测试方法名称。保证从测试方法名称中能读懂测试的目的，和简单的上下文。</span></span><br><span class="line"><span class="comment">  * 注意此处的Test引用jupiter提供的注解。不然会有注入的空指针</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="meta">@Test</span>  </span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">should_createUserWithNew_givenInfo_WhenNotExisted</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//given data; stub</span></span><br><span class="line">    <span class="keyword">when</span>(userDAO).getIdByName(any()).thenReturn(<span class="literal">null</span>);</span><br><span class="line">    <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">    <span class="keyword">when</span>(idGenerator).next().thenReturn(userId);</span><br><span class="line">    <span class="type">UserVO</span> <span class="variable">userCreate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserVo</span>(***,***,***);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//when</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">acturalUserId</span> <span class="operator">=</span> userService.createUser(userCreate);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//then</span></span><br><span class="line">    assertEquals(userId, acturalUserId);</span><br><span class="line">    <span class="comment">// 验证依赖方法</span></span><br><span class="line">    <span class="comment">// 验证依赖方法: userDAO.getByName</span></span><br><span class="line">   Mockito.verify(userDAO).getIdByName(userCreate.getName());</span><br><span class="line">   <span class="comment">// 验证依赖方法: idGenerator.next</span></span><br><span class="line">   Mockito.verify(idGenerator).next();</span><br><span class="line">   <span class="comment">// 验证依赖方法: userDAO.create</span></span><br><span class="line">   ArgumentCaptor &lt;UserDO&gt; userCreateCaptor = ArgumentCaptor.forClass(UserDO.class);</span><br><span class="line">   Mockito.verify(userDAO).create(userCreateCaptor.capture());</span><br><span class="line">   <span class="comment">// 验证依赖对象</span></span><br><span class="line">   Mockito.verifyNoMoreInteractions(idGenerator, userDAO);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">should_updateUser_givenUser_whenHasExisted</span><span class="params">()</span>&#123;</span><br><span class="line">  <span class="comment">//只需要stub此处修改，然后进行已存在断言</span></span><br><span class="line">  <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">  <span class="keyword">when</span>(userDAO).getIdByName(any()).thenReturn(userId);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//then</span></span><br><span class="line">  ....</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">should_exception_givenInvalid</span><span class="params">()</span>&#123;</span><br><span class="line">  <span class="comment">//then 断言采用Junit 5提供的</span></span><br><span class="line">  Assert.assertThrows(<span class="string">&quot;返回异常不一致&quot;</span>,</span><br><span class="line">            UnsupportedOperationException.class, () -&gt; userService.createUser(userCreate))</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="如何测试Controller"><a href="#如何测试Controller" class="headerlink" title="如何测试Controller"></a>如何测试Controller</h3><ol>
<li>保证Api层的访问状态是成功的</li>
<li>保证入参校验逻辑是可通过的。</li>
<li>与Service测试不同的是我们要启动web服务，所以必须启动spring容器。但是为了可测service服务我们还是利用Stub技术给出预期返回值。</li>
<li>利用Spring 提供的@Import({*****.class}}指定我们容器中需要的类，可以方便的避免容器需要加载所有bean很慢的尴尬。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebMvcTest(controllers = UserController.class, useDefaultFilters = false)</span></span><br><span class="line"><span class="meta">@Import(&#123;UserController.class,</span></span><br><span class="line"><span class="meta">        AopAutoConfiguration.class,</span></span><br><span class="line"><span class="meta">        DependenceService.class&#125;)</span></span><br><span class="line"><span class="meta">@ActiveProfiles(&quot;test&quot;)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserControllerTest</span> <span class="keyword">extends</span> <span class="title class_">ControllerBaseTest</span> &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  *利用Import和Autowired可以将真是的bean在运行测试的时候注入进来。会调用真是的方法。</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">    <span class="meta">@Autowired</span> </span><br><span class="line">    <span class="keyword">private</span> MockMvc mvc;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DependenceService service;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@MockBean</span></span><br><span class="line">    <span class="keyword">private</span> UserService service;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">should_200_when_create</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">      <span class="keyword">when</span>(service.createUser(any())).thenReturn(userId);</span><br><span class="line">      </span><br><span class="line">      <span class="comment">//when</span></span><br><span class="line">      mvc.perform(MockMvcRequestBuilders.post(<span class="string">&quot;/user&quot;</span>)</span><br><span class="line">                        .content(jsonString) <span class="comment">//given data</span></span><br><span class="line">                        .header(<span class="string">&quot;X-TIME-ZONE&quot;</span>, <span class="string">&quot;Asia/Shanghai&quot;</span>)</span><br><span class="line">                        .with(csrf())</span><br><span class="line">                        .contentType(MediaType.APPLICATION_JSON))</span><br><span class="line">                .andExpect(status().isOk());<span class="comment">//then</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><p>使用ArgumentCaptor验证代码中间被stub掉方法的参数.</p>
<p>存在一种情况我们给serviceA中的methodA写单元测试的过程中，发现调用了serviceB的methodB方法，并且为serviceB方法new 了一个ObjectA对象作为调用serviceB.methodB的参数，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServiceA</span> &#123;</span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">public</span> ServiceB serviceB</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">methodA</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 其它业务代码 </span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++ )&#123;</span><br><span class="line">    	<span class="type">ObjectA</span> <span class="variable">objA</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectA</span>();</span><br><span class="line">      <span class="type">ObjcetB</span> <span class="variable">objB</span> <span class="operator">=</span> serviceB.methodB(<span class="string">&quot;hello&quot;</span>, objA);  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 其它业务代码 </span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时在测试 methodA的时候，需要使用测试替身代替真实的serviceB.methodB(objA);调用，这个时候我们不能使用 Mockito.when(serviceB.methodB(eq(“hello”), eq(new ObjectA())))来进行替换，因为new出来的对象是不同的对象所以stub不住。这个时候应该使用使用ArgumentCaptor进行捕获后验证，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ArgumentCaptor&lt;ObjectA&gt; objACaptor = ArgumentCaptor.forClass(ObjectA.class);</span><br><span class="line"><span class="comment">//利用mockito.when().thenReturn()返回多个对象来stub循环中的三方调用</span></span><br><span class="line">Mockito.<span class="keyword">when</span>(serviceB.methodB(eq(<span class="string">&quot;hello&quot;</span>), objACaptor.caputre())).thenReturn(objB1, obj2, obj3);</span><br><span class="line"><span class="comment">//然后获取三次captor捕获的三个参数进行验证。</span></span><br><span class="line">List&lt;ObjectA&gt; objAs = objACaptor.getValues();</span><br><span class="line"><span class="comment">//验证三次参数</span></span><br><span class="line">Assertions.assertEquals(objAs(<span class="number">0</span>), objB1);</span><br><span class="line">Assertions.assertEquals(objAs(<span class="number">1</span>), objB2);</span><br><span class="line">Assertions.assertEquals(objAs(<span class="number">2</span>), objB2);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h3><p>Java编程技巧之单元测试用例编写流程：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/371759603">https://zhuanlan.zhihu.com/p/371759603</a></p>
<p>谈一谈单元测试：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/ioya1kzdTGPB0oOZ3DUmig">https://mp.weixin.qq.com/s/ioya1kzdTGPB0oOZ3DUmig</a></p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/Unit-Test/" rel="tag">Unit Test</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/04/07/Java%E5%A6%82%E4%BD%95%E7%BB%99%E6%96%AD%E8%A8%80%E9%9B%86%E5%90%88%E7%BB%93%E6%9E%9C%E9%9B%86/"
                    data-tooltip="Java如何断言集合结果集"
                    aria-label="PREVIOUS: Java如何断言集合结果集"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/02/11/Remove-if-else-by-Enum/"
                    data-tooltip="Remove if...else...by Enum"
                    aria-label="NEXT: Remove if...else...by Enum"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
                <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 Topsion. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/04/07/Java%E5%A6%82%E4%BD%95%E7%BB%99%E6%96%AD%E8%A8%80%E9%9B%86%E5%90%88%E7%BB%93%E6%9E%9C%E9%9B%86/"
                    data-tooltip="Java如何断言集合结果集"
                    aria-label="PREVIOUS: Java如何断言集合结果集"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2022/02/11/Remove-if-else-by-Enum/"
                    data-tooltip="Remove if...else...by Enum"
                    aria-label="NEXT: Remove if...else...by Enum"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
                <li class="post-action">
                    <a
                        class="post-action-btn btn btn--default"
                        href="#disqus_thread"
                        aria-label="Leave a comment"
                    >
                        <i class="fa fa-comment"></i>
                    </a>
                </li>
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="4">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Topsion</h4>
        
            <div id="about-card-bio"><p>Fullstack Developer</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Coder</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Xi&#39;an China
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-q2wtdh1f7oaxzdmuuvsc1uyl8fnwcg5dz7kgztdayssvj6qd6o7u5zwralwk.min.js"></script>

<!--SCRIPTS END-->


    
        <script>
          var disqus_config = function() {
            this.page.url = 'http://example.com/2022/04/04/java%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Mockito%E5%86%99%E5%A5%BD%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/';
              
            this.page.identifier = '2022/04/04/java如何利用Mockito写好单元测试/';
              
          };
          (function() {
            var d = document, s = d.createElement('script');
            var disqus_shortname = 'summary blog';
            s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();
        </script>
    




    </body>
</html>
